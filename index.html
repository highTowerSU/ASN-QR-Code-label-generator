<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>QR Code Label Generator for ASN in Paperless-ngx</title>
    <link rel="canonical" href="https://tobiasmaier.info/asn-qr-code-label-generator/" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <style>
      @media print {
        @page {
          size: 210mm 297mm;
          margin: 12mm 6mm 9mm 6mm; /* Erzwingt R채nder oben, rechts, unten, links */
        }
        body, html {
          width: 210mm;
          height: 297mm;
          margin: 0;
          padding: 0;
          overflow: hidden;
          -webkit-print-color-adjust: exact;
        }
        .print-hidden {
          display: none;
        }
      }
      .page {
        width: 210mm;
        height: 297mm;
        box-sizing: border-box;
        display: grid;
        grid-template-columns: repeat(7, 25.4mm);
        grid-template-rows: repeat(27, 10mm);
        gap: var(--gap-vertical, 0mm) var(--gap-horizontal, 0mm);
        justify-content: center;
        align-content: start;
      }
      .label {
        width: 25.4mm;
        height: 10mm;
        display: flex;
        align-items: center;
        justify-content: flex-start;
        border: var(--label-border, 0.1mm solid black);
        padding: 0mm;
        box-sizing: border-box;
        overflow: hidden;
      }
      .qr-code {
        width: 9mm;
        height: 9mm;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-left: 1mm;
      }
      .text {
        flex: 1;
        font-size: 11px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        text-align: left;
        padding-left: 2mm;
        max-width: 14mm;
        line-height: 1;
      }
      
      /* Neue Styles f체r A4-Visualisierung */
      .page-preview {
        position: relative;
        margin: 20px auto;
      }
      
      .a4-border {
        position: absolute;
        width: 210mm;
        height: 297mm;
        border: 2px solid #000;
        pointer-events: none;
      }
      
      .padding-visualization {
        position: absolute;
        width: calc(210mm - var(--padding-left) - var(--padding-right));
        height: calc(297mm - var(--padding-top) - var(--padding-bottom));
        border: 2px dashed #ff0000;
        top: var(--padding-top);
        left: var(--padding-left);
        pointer-events: none;
      }
      
      /* Beschriftungen f체r Padding */
      .padding-label {
        position: absolute;
        background: rgba(255, 0, 0, 0.1);
        color: #ff0000;
        font-size: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      
      .padding-top {
        top: 0;
        left: var(--padding-left);
        width: calc(210mm - var(--padding-left) - var(--padding-right));
        height: var(--padding-top);
      }
      
      .padding-bottom {
        bottom: 0;
        left: var(--padding-left);
        width: calc(210mm - var(--padding-left) - var(--padding-right));
        height: var(--padding-bottom);
      }
      
      .padding-left {
        top: var(--padding-top);
        left: 0;
        width: var(--padding-left);
        height: calc(297mm - var(--padding-top) - var(--padding-bottom));
      }
      
      .padding-right {
        top: var(--padding-top);
        right: 0;
        width: var(--padding-right);
        height: calc(297mm - var(--padding-top) - var(--padding-bottom));
      }
    </style>
  </head>
  <body x-data="qrCodeApp()" x-init="generateLabels()">
    <div class="container mx-auto print-hidden">
      <h1 class="mb-4 text-xl font-bold">QR Code Label Generator</h1>
      <form @submit.prevent="generateLabels()" class="mb-8">
        <!-- QR Code Configuration -->
        <div class="mb-6">
          <h2 class="text-lg font-semibold mb-3">QR Code Settings</h2>
          <div class="grid grid-cols-4 gap-5">
            <div>
              <label for="startNumber" class="block mb-1">Start Number</label>
              <input type="number" id="startNumber" x-model="startNumber" required min="1" step="1" class="border p-2 w-full" />
            </div>
            <div>
              <label for="prefix" class="block mb-1">ASN Prefix</label>
              <input type="text" id="prefix" x-model="prefix" required class="border p-2 w-full" placeholder="e.g. ASN" />
            </div>
            <div class="flex items-center">
              <input type="checkbox" id="showPrefix" x-model="showPrefix" class="border p-2 mr-2" />
              <label for="showPrefix">Display Prefix</label>
            </div>
            <div class="flex items-center">
              <input type="checkbox" id="showBorder" x-model="showBorder" class="border p-2 mr-2" />
              <label for="showBorder">Show Label Borders</label>
            </div>
          </div>
        </div>

        <!-- Page Margin Settings -->
        <div class="mb-6">
          <h2 class="text-lg font-semibold mb-3">Page Margins (mm)</h2>
          <div class="grid grid-cols-4 gap-5">
            <div>
              <label for="paddingTop" class="block mb-1">Top Margin</label>
              <input type="number" id="paddingTop" x-model="paddingTop" class="border p-2 w-full" min="0" step="0.5" />
            </div>
            <div>
              <label for="paddingRight" class="block mb-1">Right Margin</label>
              <input type="number" id="paddingRight" x-model="paddingRight" class="border p-2 w-full" min="0" step="0.5" />
            </div>
            <div>
              <label for="paddingBottom" class="block mb-1">Bottom Margin</label>
              <input type="number" id="paddingBottom" x-model="paddingBottom" class="border p-2 w-full" min="0" step="0.5" />
            </div>
            <div>
              <label for="paddingLeft" class="block mb-1">Left Margin</label>
              <input type="number" id="paddingLeft" x-model="paddingLeft" class="border p-2 w-full" min="0" step="0.5" />
            </div>
          </div>
        </div>

        <!-- Label Spacing Settings -->
        <div class="mb-6">
          <h2 class="text-lg font-semibold mb-3">Label Spacing (mm)</h2>
          <div class="grid grid-cols-2 gap-5">
            <div>
              <label for="gapVertical" class="block mb-1">Vertical Gap</label>
              <input type="number" id="gapVertical" x-model="gapVertical" class="border p-2 w-full" min="0" step="0.1" />
            </div>
            <div>
              <label for="gapHorizontal" class="block mb-1">Horizontal Gap</label>
              <input type="number" id="gapHorizontal" x-model="gapHorizontal" class="border p-2 w-full" min="0" step="0.1" />
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex gap-4">
          <button @click.prevent="generateLabels()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
            Update Labels
          </button>
          <button @click.prevent="printLabels()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
            Print Labels
          </button>
        </div>
      </form>
    </div>

    <div class="page-preview print-hidden">
      <div class="a4-border"></div>
      <div class="padding-visualization"></div>
      <div class="padding-label padding-top" x-text="paddingTop + 'mm'"></div>
      <div class="padding-label padding-bottom" x-text="paddingBottom + 'mm'"></div>
      <div class="padding-label padding-left" x-text="paddingLeft + 'mm'"></div>
      <div class="padding-label padding-right" x-text="paddingRight + 'mm'"></div>
      <div class="page" id="label-container"></div>
    </div>

    <script>
      function qrCodeApp() {
        return {
          startNumber: 1,
          prefix: "ASN",
          showPrefix: true,
          showBorder: true,
          paddingTop: 12,
          paddingRight: 6,
          paddingBottom: 9,
          paddingLeft: 6,
          gapVertical: 0,
          gapHorizontal: 0,
          labels: [],

          generateLabels() {
            this.labels = [];
            let totalLabels = 7 * 27;
            let startNumberInt = parseInt(this.startNumber, 10);
            for (let i = 0; i < totalLabels; i++) {
              let number = startNumberInt + i;
              let text = this.showPrefix ? this.prefix + number.toString().padStart(4, "0") : number.toString().padStart(4, "0");
              let qrCodeUrl = `https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent(text)}`;
              this.labels.push({ qrCodeUrl, text });
            }
            this.renderLabels();
          },

          renderLabels() {
            let container = document.getElementById("label-container");
            container.innerHTML = "";
            container.style.gap = `${this.gapVertical}mm ${this.gapHorizontal}mm`;
            container.style.setProperty('--label-border', this.showBorder ? '0.1mm solid black' : 'none');
            
            // Setze CSS-Variablen f체r Padding-Visualisierung
            document.documentElement.style.setProperty('--padding-top', this.paddingTop + 'mm');
            document.documentElement.style.setProperty('--padding-right', this.paddingRight + 'mm');
            document.documentElement.style.setProperty('--padding-bottom', this.paddingBottom + 'mm');
            document.documentElement.style.setProperty('--padding-left', this.paddingLeft + 'mm');
            
            this.labels.forEach((label) => {
              let labelDiv = document.createElement("div");
              labelDiv.classList.add("label");
              let qrImg = document.createElement("img");
              qrImg.src = label.qrCodeUrl;
              qrImg.classList.add("qr-code");
              let textDiv = document.createElement("div");
              textDiv.classList.add("text");
              textDiv.innerText = label.text;
              labelDiv.appendChild(qrImg);
              labelDiv.appendChild(textDiv);
              container.appendChild(labelDiv);
            });
          },

          printLabels() {
            window.print();
          },
        };
      }
    </script>
  </body>
</html>
